# Zoom Attendee Monitor

可以实时拉取 Zoom 会议室的参会人员名单，与本地的名单做比对，生成参会人员列表🎉🎉🎉。

## 要求
- `Zoom` 网页版，建议使用 zoom US 版本，国内的不允许免费用户登录；
- `tampermonkey` 插件，拉取名单利用 DOM 采集；
- `python`文件操作库 `shutil`（自动将比对过的名单移动到 `attendee/checked` 文件下）, `pandas` 利用 pandas 的表，按照学号进行合并表。

## 使用介绍
- 📘 标准人员名单，

    即**所有的应该参会人员名单**。示例如：`target\学号分配-20200731.xlsx`。
    
    函数 `targetStudents()` 合并了该 excel 文件中的三个不同的 `sheet`，可以根据自己的需求进行取舍。

- 📘 正则表达式制定

    用以从实时参会人员名单中采集符合标准人员名单的**名字格式**：
    ```python
    regex = re.compile(r"^(?P<id>\d{1,3})[ \-_–－~—+]*(?P<name>[\u4e00-\u9fa5 ]{2,4}).*")
    ```

- 📘 采集结果查看
  
  将`main.js` 复制到 `tampermonkey` 中，然后可以自己指定采集时间，`setInterval(main, 1000 * 60 * 1)`, 默认是间隔一分钟采集一个 txt 文件。

  然后将采集到的所有 txt 文件放到 `attendee` 文件夹下，运行 `main.py`，就可以看到 `intergration.xlsx` 文件生成，里面存储了所有实际到会的人员，空白的即为缺席人员。 顺便提一下，可以利用 excel 的筛选功能，对多列进行筛选。

  注意再次运行时需要把 `intergration.xlsx` 文件更名或者删除。


## 已知的问题
1. 没有做文件检测，需要手动 `intergration.xlsx` 文件更名和删除。因为我想自己手动做文件名记录，所以没有实现相关功能；
2. 如果想把 `checked` 文件中的重新拿出来比对，需要保证 `attendee` 中的文件不能 `checked` 中出现，否则会因为不能移动文件而出错；
3. 由于 `pandas` 的限制，最多可以同时检测 29 个 txt 文件。

如果有什么问题，可以提出 issues, 非常乐意用自己的一点点知识为他人解决问题。毕竟，**✨知识分享才能得到快乐✨**。

## Last but very important
这个程序只是为了统计到会人员，用以进一步的做数据统计和分析。严正抵制以签到要求学生必须来的做法。

个人认为，不应该专注于用签到表来要求学生到会。🎈

应该把更多注意力放在课程质量上，用心的去思考怎么能够吸引学生，而不是到会人员数字这个表面效果。毕竟网课你能限制学生必须来，而不能保证授课效果。

🏆追求捷径只会浪费资源，浪费时间，**希望大家都能更多的提升内在，为自己和国家做更好的付出。**

